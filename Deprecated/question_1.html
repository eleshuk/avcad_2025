<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Summary Statistics – AVCAD 2025 Dashboard</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">AVCAD 2025 Dashboard</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.qmd"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#prepare-data-for-analysis---exploration" id="toc-prepare-data-for-analysis---exploration" class="nav-link active" data-scroll-target="#prepare-data-for-analysis---exploration">Prepare data for analysis - exploration</a></li>
  <li><a href="#inferential-statistics" id="toc-inferential-statistics" class="nav-link" data-scroll-target="#inferential-statistics">Inferential statistics</a>
  <ul class="collapse">
  <li><a href="#tukeys-hsd-test---identify-which-specific-cover-crop-groups-differ-post-hoc-analysis-after-anova." id="toc-tukeys-hsd-test---identify-which-specific-cover-crop-groups-differ-post-hoc-analysis-after-anova." class="nav-link" data-scroll-target="#tukeys-hsd-test---identify-which-specific-cover-crop-groups-differ-post-hoc-analysis-after-anova.">Tukey’s HSD test - identify which specific cover crop groups differ (post hoc analysis after ANOVA).</a></li>
  <li><a href="#regression-analysis---models-soil-indicators-like-soc-while-controlling-for-geography-e.g.-latitude-climate-etc.." id="toc-regression-analysis---models-soil-indicators-like-soc-while-controlling-for-geography-e.g.-latitude-climate-etc.." class="nav-link" data-scroll-target="#regression-analysis---models-soil-indicators-like-soc-while-controlling-for-geography-e.g.-latitude-climate-etc..">Regression Analysis - models soil indicators (like SOC) while controlling for geography (e.g., latitude, climate, etc.).</a></li>
  <li><a href="#boxplots-with-significance-markers---visuals-showing-group-means-and-marking-pairs-with-significant-differences." id="toc-boxplots-with-significance-markers---visuals-showing-group-means-and-marking-pairs-with-significant-differences." class="nav-link" data-scroll-target="#boxplots-with-significance-markers---visuals-showing-group-means-and-marking-pairs-with-significant-differences.">Boxplots with Significance Markers - visuals showing group means and marking pairs with significant differences.</a></li>
  <li><a href="#boxplots-by-country" id="toc-boxplots-by-country" class="nav-link" data-scroll-target="#boxplots-by-country">Boxplots by Country</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Summary Statistics</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="3dd6d607-f48e-4179-b672-cecfcc053d09" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.anova <span class="im">import</span> anova_lm</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.multicomp <span class="im">import</span> pairwise_tukeyhsd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2adb2399-1916-45a5-8782-1758176c0752" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the Excel file</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">"SoilHealthDB_V2.xlsx"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>excel_file <span class="op">=</span> pd.ExcelFile(file_path)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display all sheet names</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>sheet_names <span class="op">=</span> excel_file.sheet_names</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(sheet_names)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5c154d0c-0eb3-47fb-bfd1-4f12565202b7" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load main dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>main_df <span class="op">=</span> excel_file.parse(<span class="st">'Sheet1'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display first few rows</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>main_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">StudyID</th>
<th data-quarto-table-cell-role="th">ExperimentID</th>
<th data-quarto-table-cell-role="th">Author_F</th>
<th data-quarto-table-cell-role="th">Author_G</th>
<th data-quarto-table-cell-role="th">YearPublication</th>
<th data-quarto-table-cell-role="th">SamplingYear</th>
<th data-quarto-table-cell-role="th">Journal</th>
<th data-quarto-table-cell-role="th">SiteInfor</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">MBN_C_SD</th>
<th data-quarto-table-cell-role="th">MBN_T_SD</th>
<th data-quarto-table-cell-role="th">38.MBN_Comments</th>
<th data-quarto-table-cell-role="th">Microelement</th>
<th data-quarto-table-cell-role="th">SQI</th>
<th data-quarto-table-cell-role="th">ESS</th>
<th data-quarto-table-cell-role="th">Texture_C</th>
<th data-quarto-table-cell-role="th">Comments1</th>
<th data-quarto-table-cell-role="th">Comments2</th>
<th data-quarto-table-cell-role="th">Comments3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1-1</td>
<td>Abawi</td>
<td>G.S.</td>
<td>2000</td>
<td>NaN</td>
<td>Applied Soil Ecology</td>
<td>New York</td>
<td>USA</td>
<td>40.71</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Root infected by rot</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>1-1</td>
<td>Abawi</td>
<td>G.S.</td>
<td>2000</td>
<td>NaN</td>
<td>Applied Soil Ecology</td>
<td>New York</td>
<td>USA</td>
<td>40.71</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Root infected by rot</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>1-2</td>
<td>Abawi</td>
<td>G.S.</td>
<td>2000</td>
<td>NaN</td>
<td>Applied Soil Ecology</td>
<td>New York</td>
<td>USA</td>
<td>40.71</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Root infected by rot</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>1-1</td>
<td>Abawi</td>
<td>G.S.</td>
<td>2000</td>
<td>NaN</td>
<td>Applied Soil Ecology</td>
<td>New York</td>
<td>USA</td>
<td>40.71</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Root infected by rot</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>1-4</td>
<td>Abawi</td>
<td>G.S.</td>
<td>2000</td>
<td>NaN</td>
<td>Applied Soil Ecology</td>
<td>New York</td>
<td>USA</td>
<td>40.71</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Root infected by rot</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>5 rows × 270 columns</p>
</div>
</div>
</div>
<div id="d536ee39-b25b-47d9-8830-447d70e2eb64" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View first 40 column names to explore variables</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>all_columns <span class="op">=</span> main_df.columns.tolist()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(all_columns[:<span class="dv">40</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['StudyID', 'ExperimentID', 'Author_F', 'Author_G', 'YearPublication', 'SamplingYear', 'Journal', 'SiteInfor', 'Country', 'Latitude', 'Longitude', 'Elevation', 'Tannual', 'MAT', 'Pannual', 'MAP', 'ClimateType', 'TimeAfterCoverCrop', 'Duration', 'CC_planting_date', 'CC_termination_date', 'Time_Comments', 'SamplingDepth', 'SamplingThickness', 'CEC', 'CEC_Unit', 'SoilBD', 'SandPerc', 'SiltPerc', 'ClayPerc', 'Texture', 'SoilpH', 'BackgroundSOC', 'SOC_NaturalVeg', 'SoilKsat', 'SoilFamily', 'CoverCrop', 'CoverCropGroup', 'GrainCrop', 'GrainCropGroup']</code></pre>
</div>
</div>
<div id="e9ebe534-b000-4050-ab5f-59a10b8b1179" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select columns of interest</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>columns_of_interest <span class="op">=</span> [</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Geographic</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SiteInfor'</span>, <span class="st">'Country'</span>, <span class="st">'Latitude'</span>, <span class="st">'Longitude'</span>, <span class="st">'Elevation'</span>, <span class="st">'ClimateType'</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Practices</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CoverCrop'</span>, <span class="st">'CoverCropGroup'</span>, <span class="st">'GrainCrop'</span>, <span class="st">'GrainCropGroup'</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Soil health indicators</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SoilBD'</span>, <span class="st">'SoilpH'</span>, <span class="st">'CEC'</span>, <span class="st">'MBN_C'</span>, <span class="st">'MBN_T'</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create subset</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>subset_df <span class="op">=</span> main_df[columns_of_interest]</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary overview of the subset</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(subset_df.describe(include<span class="op">=</span><span class="st">'all'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                SiteInfor Country  \
count                                                5853    5907   
unique                                                367      42   
top     Agricultural Research Station farm, Fort Valle...     USA   
freq                                                  193    2272   
mean                                                  NaN     NaN   
std                                                   NaN     NaN   
min                                                   NaN     NaN   
25%                                                   NaN     NaN   
50%                                                   NaN     NaN   
75%                                                   NaN     NaN   
max                                                   NaN     NaN   

           Latitude    Longitude    Elevation     ClimateType CoverCrop  \
count   5884.000000  5884.000000  5497.000000              55      5051   
unique          NaN          NaN          NaN               2       406   
top             NaN          NaN          NaN   Mediterranean       Rye   
freq            NaN          NaN          NaN              47       509   
mean      24.820367    -9.268017   500.234570             NaN       NaN   
std       23.541664    81.177791   523.039669             NaN       NaN   
min      -43.760000  -123.260000     1.700000             NaN       NaN   
25%        7.380000   -83.910000    55.300000             NaN       NaN   
50%       35.390000     3.900000   250.000000             NaN       NaN   
75%       40.716667    34.600000   988.000000             NaN       NaN   
max       60.700000   175.610000  2000.000000             NaN       NaN   

       CoverCropGroup GrainCrop GrainCropGroup       SoilBD       SoilpH  \
count            5062      5495           5616  1685.000000  2474.000000   
unique             22       158             23          NaN          NaN   
top            Legume     Maize           Corn          NaN          NaN   
freq             2729      1357           1847          NaN          NaN   
mean              NaN       NaN            NaN     1.361771     6.337566   
std               NaN       NaN            NaN     0.179632     1.138799   
min               NaN       NaN            NaN     0.760000     3.990000   
25%               NaN       NaN            NaN     1.260000     5.400000   
50%               NaN       NaN            NaN     1.370000     6.100000   
75%               NaN       NaN            NaN     1.460000     7.500000   
max               NaN       NaN            NaN     2.696270     8.700000   

               CEC       MBN_C       MBN_T  
count    53.000000  194.000000  194.000000  
unique         NaN         NaN         NaN  
top            NaN         NaN         NaN  
freq           NaN         NaN         NaN  
mean     32.076038   39.593624   50.257563  
std      40.168201   25.574672   34.353027  
min       3.350000    1.300000    1.500000  
25%       8.730000   20.034800   21.943800  
50%      18.800000   37.100000   47.200000  
75%      29.500000   53.500000   75.315000  
max     171.000000  187.000000  247.000000  </code></pre>
</div>
</div>
<div id="977a4531-afe6-4d17-a84c-31aa7da7ff02" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure SOC is included</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>subset_df.loc[:, <span class="st">'SOC'</span>] <span class="op">=</span> main_df[<span class="st">'BackgroundSOC'</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define indicators</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>soil_indicators <span class="op">=</span> [<span class="st">'SoilBD'</span>, <span class="st">'SoilpH'</span>, <span class="st">'CEC'</span>, <span class="st">'SOC'</span>, <span class="st">'MBN_C'</span>, <span class="st">'MBN_T'</span>]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics by CoverCropGroup (per column, dropping NaNs)</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>summary_by_covercrop <span class="op">=</span> subset_df.groupby(<span class="st">'CoverCropGroup'</span>)[soil_indicators].agg([<span class="st">'count'</span>, <span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>])</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics by Country (per column, dropping NaNs)</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>summary_by_country <span class="op">=</span> subset_df.groupby(<span class="st">'Country'</span>)[soil_indicators].agg([<span class="st">'count'</span>, <span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>])</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Summary by CoverCropGroup:\n", summary_by_covercrop)</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># print("\nSummary by Country:\n", summary_by_country)</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>summary_by_covercrop.head()</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>summary_by_country.head(<span class="dv">50</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="5" data-quarto-table-cell-role="th" data-halign="left">SoilBD</th>
<th colspan="5" data-quarto-table-cell-role="th" data-halign="left">SoilpH</th>
<th colspan="5" data-quarto-table-cell-role="th" data-halign="left">CEC</th>
<th colspan="5" data-quarto-table-cell-role="th" data-halign="left">SOC</th>
<th colspan="5" data-quarto-table-cell-role="th" data-halign="left">MBN_C</th>
<th colspan="5" data-quarto-table-cell-role="th" data-halign="left">MBN_T</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Argentina</td>
<td>64</td>
<td>1.214167</td>
<td>0.099462</td>
<td>1.130000</td>
<td>1.46000</td>
<td>6</td>
<td>6.000000</td>
<td>0.000000</td>
<td>6.000000</td>
<td>6.00</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>8</td>
<td>2.527500</td>
<td>0.235175</td>
<td>2.300000</td>
<td>2.800000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Australia</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>8</td>
<td>5.775000</td>
<td>0.520302</td>
<td>5.400000</td>
<td>6.60</td>
<td>2</td>
<td>4.550000</td>
<td>0.212132</td>
<td>4.40</td>
<td>4.70</td>
<td>8</td>
<td>0.995000</td>
<td>0.257516</td>
<td>0.600000</td>
<td>1.190000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bangladesh</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Benin</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4</td>
<td>5.250000</td>
<td>0.404145</td>
<td>4.900000</td>
<td>5.60</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Brazil</td>
<td>39</td>
<td>1.270103</td>
<td>0.172382</td>
<td>0.989000</td>
<td>1.50000</td>
<td>25</td>
<td>5.080800</td>
<td>0.750805</td>
<td>4.500000</td>
<td>6.31</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>17</td>
<td>1.730729</td>
<td>0.984797</td>
<td>0.812000</td>
<td>3.612000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Cameroon</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>22</td>
<td>5.181818</td>
<td>0.113961</td>
<td>5.000000</td>
<td>5.25</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>16</td>
<td>1.800000</td>
<td>0.103280</td>
<td>1.700000</td>
<td>1.900000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Canada</td>
<td>104</td>
<td>1.504839</td>
<td>0.123546</td>
<td>1.289758</td>
<td>1.69000</td>
<td>22</td>
<td>6.795455</td>
<td>1.126933</td>
<td>5.000000</td>
<td>7.60</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>28</td>
<td>3.296000</td>
<td>1.376452</td>
<td>1.672000</td>
<td>4.466000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">China</td>
<td>315</td>
<td>1.270389</td>
<td>0.104592</td>
<td>1.080000</td>
<td>1.47000</td>
<td>510</td>
<td>6.912627</td>
<td>1.278658</td>
<td>3.990000</td>
<td>8.30</td>
<td>2</td>
<td>13.480000</td>
<td>1.159655</td>
<td>12.66</td>
<td>14.30</td>
<td>636</td>
<td>2.170725</td>
<td>1.535821</td>
<td>0.260000</td>
<td>6.100000</td>
<td>42</td>
<td>44.152381</td>
<td>20.963508</td>
<td>1.30</td>
<td>76.85</td>
<td>42</td>
<td>52.359048</td>
<td>24.180159</td>
<td>3.00</td>
<td>115.06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Costa Rica</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Denmark</td>
<td>32</td>
<td>1.364238</td>
<td>0.047516</td>
<td>1.330300</td>
<td>1.54000</td>
<td>44</td>
<td>6.397727</td>
<td>0.199405</td>
<td>6.100000</td>
<td>7.10</td>
<td>4</td>
<td>129.750000</td>
<td>21.328776</td>
<td>110.00</td>
<td>160.00</td>
<td>57</td>
<td>2.159930</td>
<td>0.663736</td>
<td>1.280000</td>
<td>3.100000</td>
<td>24</td>
<td>30.500000</td>
<td>3.162278</td>
<td>27.00</td>
<td>36.00</td>
<td>24</td>
<td>37.791667</td>
<td>6.379172</td>
<td>27.00</td>
<td>53.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">England</td>
<td>2</td>
<td>0.930000</td>
<td>0.169706</td>
<td>0.810000</td>
<td>1.05000</td>
<td>2</td>
<td>7.550000</td>
<td>0.070711</td>
<td>7.500000</td>
<td>7.60</td>
<td>3</td>
<td>15.070000</td>
<td>6.101008</td>
<td>8.73</td>
<td>20.90</td>
<td>5</td>
<td>2.092419</td>
<td>0.636923</td>
<td>1.511628</td>
<td>3.093023</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">France</td>
<td>14</td>
<td>1.222857</td>
<td>0.175035</td>
<td>1.000000</td>
<td>1.52000</td>
<td>20</td>
<td>6.900000</td>
<td>0.263579</td>
<td>6.200000</td>
<td>7.20</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>12</td>
<td>1.160000</td>
<td>0.000000</td>
<td>1.160000</td>
<td>1.160000</td>
<td>1</td>
<td>100.000000</td>
<td>NaN</td>
<td>100.00</td>
<td>100.00</td>
<td>1</td>
<td>130.000000</td>
<td>NaN</td>
<td>130.00</td>
<td>130.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Germany</td>
<td>26</td>
<td>1.449478</td>
<td>0.095068</td>
<td>1.300000</td>
<td>1.64000</td>
<td>6</td>
<td>6.033333</td>
<td>0.051640</td>
<td>6.000000</td>
<td>6.10</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>9</td>
<td>1.518918</td>
<td>1.223361</td>
<td>0.686525</td>
<td>3.150000</td>
<td>3</td>
<td>1.666667</td>
<td>0.288675</td>
<td>1.50</td>
<td>2.00</td>
<td>3</td>
<td>1.766667</td>
<td>0.251661</td>
<td>1.50</td>
<td>2.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Ghana</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>20</td>
<td>4.917000</td>
<td>0.230380</td>
<td>4.770000</td>
<td>5.26</td>
<td>6</td>
<td>3.505000</td>
<td>0.169794</td>
<td>3.35</td>
<td>3.66</td>
<td>20</td>
<td>0.556000</td>
<td>0.056419</td>
<td>0.520000</td>
<td>0.640000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Greece</td>
<td>3</td>
<td>1.490000</td>
<td>0.000000</td>
<td>1.490000</td>
<td>1.49000</td>
<td>7</td>
<td>7.724286</td>
<td>0.331404</td>
<td>7.370000</td>
<td>7.99</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7</td>
<td>43.142857</td>
<td>25.122557</td>
<td>23.00</td>
<td>70.00</td>
<td>7</td>
<td>44.428571</td>
<td>37.464904</td>
<td>13.00</td>
<td>100.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Guinea</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">India</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Indonesia</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7</td>
<td>4.455714</td>
<td>0.616654</td>
<td>4.000000</td>
<td>5.75</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7</td>
<td>3.222857</td>
<td>0.667551</td>
<td>2.290000</td>
<td>4.010000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Italy</td>
<td>24</td>
<td>1.442500</td>
<td>0.035661</td>
<td>1.400000</td>
<td>1.48000</td>
<td>52</td>
<td>8.063077</td>
<td>0.323907</td>
<td>6.900000</td>
<td>8.40</td>
<td>1</td>
<td>23.000000</td>
<td>NaN</td>
<td>23.00</td>
<td>23.00</td>
<td>15</td>
<td>0.804000</td>
<td>0.218209</td>
<td>0.390000</td>
<td>0.950000</td>
<td>2</td>
<td>44.950000</td>
<td>22.839549</td>
<td>28.80</td>
<td>61.10</td>
<td>2</td>
<td>54.800000</td>
<td>37.900923</td>
<td>28.00</td>
<td>81.60</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kenya</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>100</td>
<td>5.433000</td>
<td>0.167003</td>
<td>5.000000</td>
<td>5.70</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>100</td>
<td>1.387490</td>
<td>0.621590</td>
<td>0.140000</td>
<td>1.790000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Malawi</td>
<td>33</td>
<td>1.300000</td>
<td>0.082916</td>
<td>1.200000</td>
<td>1.40000</td>
<td>183</td>
<td>5.913005</td>
<td>0.252365</td>
<td>5.300000</td>
<td>6.50</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>180</td>
<td>1.176978</td>
<td>0.475998</td>
<td>0.585000</td>
<td>2.110000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Netherland</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>8</td>
<td>7.947500</td>
<td>1.071977</td>
<td>5.460000</td>
<td>8.46</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>6</td>
<td>0.893200</td>
<td>0.000000</td>
<td>0.893200</td>
<td>0.893200</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New Zealand</td>
<td>7</td>
<td>1.070000</td>
<td>0.000000</td>
<td>1.070000</td>
<td>1.07000</td>
<td>7</td>
<td>6.100000</td>
<td>0.000000</td>
<td>6.100000</td>
<td>6.10</td>
<td>7</td>
<td>19.742857</td>
<td>6.810251</td>
<td>7.80</td>
<td>28.50</td>
<td>7</td>
<td>4.840000</td>
<td>0.000000</td>
<td>4.840000</td>
<td>4.840000</td>
<td>14</td>
<td>62.071429</td>
<td>12.206331</td>
<td>50.00</td>
<td>86.00</td>
<td>14</td>
<td>75.857143</td>
<td>23.260588</td>
<td>27.00</td>
<td>120.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Nigeria</td>
<td>86</td>
<td>1.306744</td>
<td>0.014828</td>
<td>1.240000</td>
<td>1.31000</td>
<td>281</td>
<td>7.256940</td>
<td>0.867354</td>
<td>4.400000</td>
<td>7.80</td>
<td>4</td>
<td>7.180000</td>
<td>1.004589</td>
<td>6.31</td>
<td>8.05</td>
<td>357</td>
<td>1.733894</td>
<td>0.579176</td>
<td>0.570000</td>
<td>2.170000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Norway</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4</td>
<td>41.050000</td>
<td>4.884329</td>
<td>36.70</td>
<td>46.60</td>
<td>4</td>
<td>51.600000</td>
<td>2.655811</td>
<td>49.30</td>
<td>53.90</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Peru</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Philippines</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Poland</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Republic of Moldova</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2</td>
<td>6.100000</td>
<td>0.000000</td>
<td>6.100000</td>
<td>6.10</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Russia</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Rwanda</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">South Korea</td>
<td>2</td>
<td>1.200000</td>
<td>0.000000</td>
<td>1.200000</td>
<td>1.20000</td>
<td>6</td>
<td>6.333333</td>
<td>0.206559</td>
<td>6.200000</td>
<td>6.60</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>6</td>
<td>1.876667</td>
<td>0.253035</td>
<td>1.550000</td>
<td>2.040000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Spain</td>
<td>8</td>
<td>1.270000</td>
<td>0.074833</td>
<td>1.200000</td>
<td>1.34000</td>
<td>58</td>
<td>7.989885</td>
<td>0.244408</td>
<td>7.853333</td>
<td>8.70</td>
<td>3</td>
<td>125.333333</td>
<td>44.545857</td>
<td>82.00</td>
<td>171.00</td>
<td>60</td>
<td>1.368220</td>
<td>1.511281</td>
<td>0.759800</td>
<td>7.900000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Sweden</td>
<td>1</td>
<td>1.360000</td>
<td>NaN</td>
<td>1.360000</td>
<td>1.36000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Switzerland</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Tanzania</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>43</td>
<td>6.737209</td>
<td>0.998337</td>
<td>5.900000</td>
<td>7.90</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>43</td>
<td>1.297674</td>
<td>0.599002</td>
<td>0.600000</td>
<td>1.800000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Togo</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>58</td>
<td>5.906897</td>
<td>0.140003</td>
<td>5.700000</td>
<td>6.00</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>40</td>
<td>0.800000</td>
<td>0.000000</td>
<td>0.800000</td>
<td>0.800000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Turkey</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>41</td>
<td>6.888780</td>
<td>0.360390</td>
<td>6.700000</td>
<td>7.56</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>41</td>
<td>2.115854</td>
<td>0.733352</td>
<td>0.750000</td>
<td>2.500000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">USA</td>
<td>868</td>
<td>1.392644</td>
<td>0.197964</td>
<td>0.760000</td>
<td>2.69627</td>
<td>461</td>
<td>6.443004</td>
<td>0.707495</td>
<td>5.344444</td>
<td>8.30</td>
<td>21</td>
<td>24.419524</td>
<td>7.513420</td>
<td>9.90</td>
<td>34.60</td>
<td>415</td>
<td>1.250704</td>
<td>0.668401</td>
<td>0.470000</td>
<td>4.508772</td>
<td>97</td>
<td>36.749104</td>
<td>29.374506</td>
<td>4.41</td>
<td>187.00</td>
<td>97</td>
<td>49.686467</td>
<td>40.712847</td>
<td>7.56</td>
<td>247.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Uganda</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>96</td>
<td>5.216667</td>
<td>0.168377</td>
<td>4.800000</td>
<td>5.60</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>96</td>
<td>2.835417</td>
<td>0.493106</td>
<td>2.100000</td>
<td>5.600000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Zambia</td>
<td>57</td>
<td>1.504386</td>
<td>0.186739</td>
<td>1.180000</td>
<td>1.61000</td>
<td>342</td>
<td>5.144620</td>
<td>0.382607</td>
<td>4.350000</td>
<td>5.60</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>380</td>
<td>0.779526</td>
<td>0.270713</td>
<td>0.400000</td>
<td>1.400000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Zimbabwe</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>33</td>
<td>4.745455</td>
<td>0.117502</td>
<td>4.500000</td>
<td>4.80</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>33</td>
<td>0.492727</td>
<td>0.015667</td>
<td>0.460000</td>
<td>0.500000</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8b5adadf-6ade-41e3-92ce-6443b29d09a2" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cover_crop_map <span class="op">=</span> {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'No'</span>: <span class="st">'None'</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Not_available'</span>: <span class="st">'None'</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Legume'</span>: <span class="st">'Legume'</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Grass'</span>: <span class="st">'Grass'</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Brassica'</span>: <span class="st">'Brassica'</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mixed'</span>: <span class="st">'Mixed'</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Broadleaf'</span>: <span class="st">'Other'</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Broadleaf/Brassica'</span>: <span class="st">'Other'</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LB'</span>: <span class="st">'Mixed'</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LG'</span>: <span class="st">'Mixed'</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LL'</span>: <span class="st">'Mixed'</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MMT'</span>: <span class="st">'Other'</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MOT'</span>: <span class="st">'Other'</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GG'</span>: <span class="st">'Grass'</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LT'</span>: <span class="st">'Legume'</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Legume_Tree'</span>: <span class="st">'Legume'</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Rye'</span>: <span class="st">'Grass'</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'M'</span>: <span class="st">'Mixed'</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Other'</span>: <span class="st">'Other'</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>main_df[<span class="st">'CoverCropGroup_clean'</span>] <span class="op">=</span> main_df[<span class="st">'CoverCropGroup'</span>].<span class="bu">map</span>(cover_crop_map).fillna(<span class="st">'Other'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="93d9dbd8-2654-472d-8490-598c8a389113" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simplify_tillage(value):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(value):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Unknown'</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> <span class="bu">str</span>(value).lower()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'no'</span> <span class="kw">in</span> value <span class="kw">or</span> <span class="st">'nt'</span> <span class="kw">in</span> value:</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'No-till'</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">'reduced'</span> <span class="kw">in</span> value <span class="kw">or</span> <span class="st">'minimum'</span> <span class="kw">in</span> value <span class="kw">or</span> <span class="st">'strip'</span> <span class="kw">in</span> value:</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Reduced-till'</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">'conventional'</span> <span class="kw">in</span> value <span class="kw">or</span> <span class="st">'moldboard'</span> <span class="kw">in</span> value <span class="kw">or</span> <span class="st">'intensive'</span> <span class="kw">in</span> value:</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Conventional'</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Other'</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>main_df[<span class="st">'Tillage_clean'</span>] <span class="op">=</span> main_df[<span class="st">'Tillage_Top_T'</span>].<span class="bu">apply</span>(simplify_tillage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="prepare-data-for-analysis---exploration" class="level3">
<h3 class="anchored" data-anchor-id="prepare-data-for-analysis---exploration">Prepare data for analysis - exploration</h3>
<div id="3bc22c3e-d3ff-4bff-bf59-1d48a7a1acd4" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>viz_df <span class="op">=</span> main_df[[</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CoverCropGroup_clean'</span>, <span class="st">'Tillage_clean'</span>, <span class="st">'Country'</span>, <span class="st">'Latitude'</span>, <span class="st">'Elevation'</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SoilBD'</span>, <span class="st">'SoilpH'</span>, <span class="st">'CEC'</span>, <span class="st">'BackgroundSOC'</span>, <span class="st">'MBN_T'</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>]].rename(columns<span class="op">=</span>{<span class="st">'BackgroundSOC'</span>: <span class="st">'SOC'</span>})</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>viz_df.dropna(subset<span class="op">=</span>[<span class="st">'CoverCropGroup_clean'</span>, <span class="st">'Tillage_clean'</span>, <span class="st">'SOC'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fa6e72a0-8b1f-4f72-a32e-f5df024408db" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>viz_df,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'CoverCropGroup_clean'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'SOC'</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    col<span class="op">=</span><span class="st">'Tillage_clean'</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">'box'</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    col_wrap<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    aspect<span class="op">=</span><span class="fl">1.3</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    sharey<span class="op">=</span><span class="va">False</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="bb034191-6e44-4e4f-becf-20501fd6d9ec" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure SOC and relevant management variables are present</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> main_df</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'SOC'</span> <span class="kw">not</span> <span class="kw">in</span> main_df.columns:</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    main_df[<span class="st">'SOC'</span>] <span class="op">=</span> main_df[<span class="st">'BackgroundSOC'</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>management_vars <span class="op">=</span> [<span class="st">'CoverCropGroup'</span>, <span class="st">'Tillage_Top_T'</span>, <span class="st">'Rotation_Top_T'</span>, <span class="st">'GrainCropGroup'</span>, <span class="st">'Grazing_Top_T'</span>]</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>anova_results <span class="op">=</span> {}</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>tukey_results <span class="op">=</span> {}</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> management_vars:</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> var <span class="kw">in</span> df.columns:</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        temp_df <span class="op">=</span> df[[<span class="st">'SOC'</span>, var]].dropna()</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> temp_df[var].nunique() <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># One-way ANOVA</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> ols(<span class="ss">f'SOC ~ C(</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">)'</span>, data<span class="op">=</span>temp_df).fit()</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        anova_table <span class="op">=</span> anova_lm(model, typ<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        anova_results[var] <span class="op">=</span> anova_table</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Tukey HSD</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        tukey <span class="op">=</span> pairwise_tukeyhsd(endog<span class="op">=</span>temp_df[<span class="st">'SOC'</span>], groups<span class="op">=</span>temp_df[var], alpha<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        tukey_results[var] <span class="op">=</span> tukey.summary()</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Boxplot with groupings</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        sns.boxplot(data<span class="op">=</span>temp_df, x<span class="op">=</span>var, y<span class="op">=</span><span class="st">'SOC'</span>)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="ss">f'SOC by </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-12-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-12-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3e7adb23-2791-4896-a9ff-d5fc0c7a1746" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.anova <span class="im">import</span> anova_lm</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.multicomp <span class="im">import</span> pairwise_tukeyhsd</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace with your actual DataFrame</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> main_df.copy()</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure SOC is numeric and management variables are present</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>management_vars <span class="op">=</span> [<span class="st">'CoverCropGroup'</span>, <span class="st">'Tillage_Top_T'</span>, <span class="st">'Rotation_Top_T'</span>, <span class="st">'GrainCropGroup'</span>, <span class="st">'Grazing_Top_T'</span>]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>tukey_results <span class="op">=</span> {}</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> management_vars:</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> var <span class="kw">in</span> df.columns:</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>        temp_df <span class="op">=</span> df[[<span class="st">'SOC'</span>, var]].dropna()</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ensure SOC is numeric</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        temp_df <span class="op">=</span> temp_df[temp_df[<span class="st">'SOC'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">isinstance</span>(x, (<span class="bu">int</span>, <span class="bu">float</span>)))]</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> temp_df[var].nunique() <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Skipping </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">: only one category present."</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- Tukey HSD Results for </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss"> ---"</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Run ANOVA to ensure differences exist</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> ols(<span class="ss">f'SOC ~ C(</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">)'</span>, data<span class="op">=</span>temp_df).fit()</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>        anova_table <span class="op">=</span> anova_lm(model, typ<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"ANOVA Table:"</span>)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(anova_table)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Tukey HSD</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        tukey <span class="op">=</span> pairwise_tukeyhsd(endog<span class="op">=</span>temp_df[<span class="st">'SOC'</span>], groups<span class="op">=</span>temp_df[var], alpha<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        tukey_results[var] <span class="op">=</span> tukey.summary()</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(tukey_results[var])</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot boxplot with group labels</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        sns.boxplot(data<span class="op">=</span>temp_df, x<span class="op">=</span>var, y<span class="op">=</span><span class="st">'SOC'</span>)</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="ss">f'Soil Organic Carbon (SOC) by </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>        plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>        plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Tukey HSD Results for CoverCropGroup ---
ANOVA Table:
                        sum_sq      df          F         PR(&gt;F)
C(CoverCropGroup)   533.109344    15.0  43.451048  1.920378e-113
Residual           1949.983925  2384.0        NaN            NaN
            Multiple Comparison of Means - Tukey HSD, FWER=0.05             
============================================================================
      group1             group2       meandiff p-adj   lower   upper  reject
----------------------------------------------------------------------------
               AVG           Brassica   0.1037    1.0 -0.6314  0.8388  False
               AVG          Broadleaf    -0.15    1.0 -0.9876  0.6876  False
               AVG Broadleaf/Brassica  -1.4196 0.9781 -4.5855  1.7462  False
               AVG              Grass   1.0581    0.0  0.4005  1.7157   True
               AVG                 LB   1.3194 0.3301 -0.3558  2.9946  False
               AVG                 LG  -0.0792    1.0  -0.799  0.6407  False
               AVG                 LL  -0.6939 0.0742 -1.4148   0.027  False
               AVG             Legume  -0.2599 0.9914 -0.8982  0.3784  False
               AVG        Legume_Tree   0.1418    1.0 -0.5411  0.8247  False
               AVG                MMT  -0.4206 0.9954 -1.5173  0.6761  False
               AVG                MOT   0.3669 0.9944 -0.5722   1.306  False
               AVG              Mixed  -0.6103 0.7712 -1.6114  0.3908  False
               AVG                 No   1.3386 0.0012  0.2954  2.3817   True
               AVG      Not_available   0.5094    1.0 -1.7735  2.7923  False
               AVG                Rye  -0.2669 0.9955  -0.964  0.4303  False
          Brassica          Broadleaf  -0.2537 0.9955 -0.9171  0.4097  False
          Brassica Broadleaf/Brassica  -1.5233 0.9539 -4.6476  1.6009  False
          Brassica              Grass   0.9543    0.0  0.5408  1.3678   True
          Brassica                 LB   1.2157 0.3893 -0.3796  2.8109  False
          Brassica                 LG  -0.1829 0.9976 -0.6896  0.3239  False
          Brassica                 LL  -0.7977    0.0 -1.3058 -0.2895   True
          Brassica             Legume  -0.3636 0.0828 -0.7456  0.0184  False
          Brassica        Legume_Tree   0.0381    1.0 -0.4145  0.4908  False
          Brassica                MMT  -0.5243 0.8962 -1.4945  0.4458  False
          Brassica                MOT   0.2632  0.999 -0.5246  1.0509  False
          Brassica              Mixed   -0.714 0.2441 -1.5747  0.1467  False
          Brassica                 No   1.2349 0.0004  0.3256  2.1441   True
          Brassica      Not_available   0.4057    1.0 -1.8193  2.6306  False
          Brassica                Rye  -0.3706 0.3427 -0.8445  0.1033  False
         Broadleaf Broadleaf/Brassica  -1.2696 0.9923 -4.4196  1.8803  False
         Broadleaf              Grass   1.2081    0.0  0.6317  1.7844   True
         Broadleaf                 LB   1.4694 0.1442 -0.1756  3.1144  False
         Broadleaf                 LG   0.0708    1.0 -0.5757  0.7174  False
         Broadleaf                 LL  -0.5439 0.2255 -1.1916  0.1037  False
         Broadleaf             Legume  -0.1099    1.0 -0.6641  0.4444  False
         Broadleaf        Legume_Tree   0.2918  0.958 -0.3133  0.8969  False
         Broadleaf                MMT  -0.2706    1.0 -1.3206  0.7794  False
         Broadleaf                MOT   0.5169 0.8227 -0.3673  1.4011  False
         Broadleaf              Mixed  -0.4603 0.9562 -1.4101  0.4894  False
         Broadleaf                 No   1.4886    0.0  0.4946  2.4825   True
         Broadleaf      Not_available   0.6594 0.9998 -1.6015  2.9202  False
         Broadleaf                Rye  -0.1169    1.0  -0.738  0.5043  False
Broadleaf/Brassica              Grass   2.4777 0.3085 -0.6293  5.5846  False
Broadleaf/Brassica                 LB    2.739 0.3252  -0.729   6.207  False
Broadleaf/Brassica                 LG   1.3405 0.9854 -1.7803  4.4612  False
Broadleaf/Brassica                 LL   0.7257    1.0 -2.3953  3.8466  False
Broadleaf/Brassica             Legume   1.1597 0.9965 -1.9432  4.2627  False
Broadleaf/Brassica        Legume_Tree   1.5614 0.9416  -1.551  4.6739  False
Broadleaf/Brassica                MMT    0.999 0.9996 -2.2295  4.2275  False
Broadleaf/Brassica                MOT   1.7865 0.8631  -1.392   4.965  False
Broadleaf/Brassica              Mixed   0.8093    1.0  -2.388  4.0066  False
Broadleaf/Brassica                 No   2.7582 0.1933 -0.4525  5.9689  False
Broadleaf/Brassica      Not_available    1.929 0.9356   -1.87   5.728  False
Broadleaf/Brassica                Rye   1.1527 0.9969 -1.9628  4.2683  False
             Grass                 LB   0.2613    1.0 -1.2998  1.8224  False
             Grass                 LG  -1.1372    0.0 -1.5231 -0.7514   True
             Grass                 LL   -1.752    0.0 -2.1397 -1.3643   True
             Grass             Legume  -1.3179    0.0  -1.513 -1.1229   True
             Grass        Legume_Tree  -0.9162    0.0 -1.2277 -0.6048   True
             Grass                MMT  -1.4787    0.0 -2.3916 -0.5658   True
             Grass                MOT  -0.6912 0.0721 -1.4071  0.0248  False
             Grass              Mixed  -1.6684    0.0 -2.4639 -0.8728   True
             Grass                 No   0.2805 0.9991 -0.5673  1.1283  False
             Grass      Not_available  -0.5487    1.0 -2.7492  1.6519  False
             Grass                Rye  -1.3249    0.0 -1.6665 -0.9833   True
                LB                 LG  -1.3985 0.1612 -2.9869  0.1898  False
                LB                 LL  -2.0133 0.0016 -3.6021 -0.4246   True
                LB             Legume  -1.5793 0.0415 -3.1323 -0.0262   True
                LB        Legume_Tree  -1.1776 0.4208 -2.7494  0.3943  False
                LB                MMT    -1.74 0.0676 -3.5309  0.0509  False
                LB                MOT  -0.9525 0.8655 -2.6515  0.7465  False
                LB              Mixed  -1.9297 0.0132 -3.6637 -0.1957   True
                LB                 No   0.0192    1.0 -1.7394  1.7778  False
                LB      Not_available    -0.81 0.9997 -3.4963  1.8763  False
                LB                Rye  -1.5863 0.0473 -3.1644 -0.0081   True
                LG                 LL  -0.6148 0.0016 -1.1007 -0.1289   True
                LG             Legume  -0.1807 0.9296 -0.5326  0.1712  False
                LG        Legume_Tree    0.221 0.9259 -0.2066  0.6485  False
                LG                MMT  -0.3415 0.9979 -1.3002  0.6173  False
                LG                MOT    0.446 0.8377 -0.3275  1.2196  False
                LG              Mixed  -0.5312 0.7329 -1.3789  0.3166  False
                LG                 No   1.4177    0.0  0.5207  2.3147   True
                LG      Not_available   0.5885 0.9999 -1.6314  2.8085  False
                LG                Rye  -0.1877  0.989 -0.6377  0.2623  False
                LL             Legume   0.4341 0.0028  0.0801   0.788   True
                LL        Legume_Tree   0.8358    0.0  0.4065   1.265   True
                LL                MMT   0.2733 0.9999 -0.6862  1.2328  False
                LL                MOT   1.0608 0.0003  0.2863  1.8353   True
                LL              Mixed   0.0836    1.0  -0.765  0.9322  False
                LL                 No   2.0325    0.0  1.1347  2.9303   True
                LL      Not_available   1.2033 0.8941 -1.0169  3.4236  False
                LL                Rye   0.4271 0.0879 -0.0245  0.8787  False
            Legume        Legume_Tree   0.4017    0.0  0.1335    0.67   True
            Legume                MMT  -0.1607    1.0 -1.0598  0.7383  False
            Legume                MOT   0.6268 0.1386 -0.0715  1.3251  False
            Legume              Mixed  -0.3504 0.9776 -1.1301  0.4292  False
            Legume                 No   1.5985    0.0  0.7655  2.4314   True
            Legume      Not_available   0.7693 0.9983 -1.4256  2.9641  False
            Legume                Rye   -0.007    1.0 -0.3097  0.2958  False
       Legume_Tree                MMT  -0.5624 0.7834 -1.4937  0.3688  False
       Legume_Tree                MOT   0.2251 0.9997 -0.5142  0.9643  False
       Legume_Tree              Mixed  -0.7521 0.1116 -1.5687  0.0644  False
       Legume_Tree                 No   1.1967 0.0003  0.3292  2.0643   True
       Legume_Tree      Not_available   0.3676    1.0 -1.8407  2.5758  False
       Legume_Tree                Rye  -0.4087 0.0274 -0.7968 -0.0206   True
               MMT                MOT   0.7875 0.5595 -0.3451  1.9202  False
               MMT              Mixed  -0.1897    1.0 -1.3742  0.9949  False
               MMT                 No   1.7592 0.0001  0.5389  2.9795   True
               MMT      Not_available     0.93 0.9941 -1.4391  3.2991  False
               MMT                Rye   0.1537    1.0  -0.788  1.0955  False
               MOT              Mixed  -0.9772 0.0937 -2.0176  0.0632  False
               MOT                 No   0.9717 0.1369 -0.1092  2.0526  False
               MOT      Not_available   0.1425    1.0 -2.1579  2.4429  False
               MOT                Rye  -0.6338 0.2213 -1.3863  0.1187  False
             Mixed                 No   1.9489    0.0  0.8137  3.0841   True
             Mixed      Not_available   1.1197 0.9587 -1.2067  3.4461  False
             Mixed                Rye   0.3434 0.9897 -0.4851   1.172  False
                No      Not_available  -0.8292 0.9981  -3.174  1.5156  False
                No                Rye  -1.6055    0.0 -2.4843 -0.7266   True
     Not_available                Rye  -0.7763 0.9983 -2.9889  1.4364  False
----------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-13-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Tukey HSD Results for Tillage_Top_T ---
ANOVA Table:
                      sum_sq     df        F  PR(&gt;F)
C(Tillage_Top_T)    2.336400    1.0  3.66116  0.0567
Residual          181.236964  284.0      NaN     NaN
Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
    CT     NT   0.1826 0.0567 -0.0052 0.3704  False
---------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-13-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Tukey HSD Results for GrainCropGroup ---
ANOVA Table:
                        sum_sq      df          F         PR(&gt;F)
C(GrainCropGroup)   609.207176    18.0  33.039534  4.064026e-102
Residual           2561.959674  2501.0        NaN            NaN
   Multiple Comparison of Means - Tukey HSD, FWER=0.05    
==========================================================
  group1    group2  meandiff p-adj   lower   upper  reject
----------------------------------------------------------
      AVG    Arable   0.5075 0.1202 -0.0459  1.0609  False
      AVG        CO  -1.1348 0.0595 -2.2873  0.0178  False
      AVG        CS   0.0529    1.0 -1.0321  1.1379  False
      AVG       CSO   1.1572 0.0225  0.0722  2.2422   True
      AVG       CSW  -0.9317 0.9904 -3.0538  1.1903  False
      AVG        CV  -0.8615 0.0016 -1.5483 -0.1747   True
      AVG       CVO  -0.0417    1.0 -0.9127  0.8293  False
      AVG      Corn  -0.3795  0.542 -0.9096  0.1506  False
      AVG       MTT  -0.0928    1.0 -1.9489  1.7632  False
      AVG     Maize  -0.8428 0.2856 -1.8743  0.1886  False
      AVG   Orchard  -0.6287 0.0248 -1.2225 -0.0349   True
      AVG     Other  -0.0328    1.0 -2.1549  2.0892  False
      AVG   Pasture   2.6604 0.0001  0.8044  4.5164   True
      AVG   Sorghum  -0.9573 0.3934 -2.1982  0.2837  False
      AVG   Soybean   0.6187  0.557 -0.2523  1.4897  False
      AVG Vegetable   0.5616 0.0392  0.0116  1.1117   True
      AVG        WO  -0.6288 0.4354 -1.4616  0.2039  False
      AVG     Wheat    -0.52 0.1564 -1.1047  0.0648  False
   Arable        CO  -1.6423    0.0 -2.6884 -0.5962   True
   Arable        CS  -0.4546 0.9809 -1.4258  0.5165  False
   Arable       CSO   0.6496 0.6694 -0.3215  1.6208  False
   Arable       CSW  -1.4392 0.5949 -3.5054  0.6269  False
   Arable        CV   -1.369    0.0 -1.8565 -0.8815   True
   Arable       CVO  -0.5492  0.427 -1.2734   0.175  False
   Arable      Corn   -0.887    0.0 -1.1035 -0.6704   True
   Arable       MTT  -0.6004 0.9997 -2.3922  1.1915  False
   Arable     Maize  -1.3504    0.0 -2.2613 -0.4395   True
   Arable   Orchard  -1.1362    0.0 -1.4805 -0.7919   True
   Arable     Other  -0.5404    1.0 -2.6065  1.5258  False
   Arable   Pasture   2.1529 0.0035  0.3611  3.9448   True
   Arable   Sorghum  -1.4648  0.001 -2.6076  -0.322   True
   Arable   Soybean   0.1112    1.0  -0.613  0.8354  False
   Arable Vegetable   0.0541    1.0 -0.2075  0.3158  False
   Arable        WO  -1.1364    0.0 -1.8141 -0.4586   True
   Arable     Wheat  -1.0275    0.0 -1.3558 -0.6991   True
       CO        CS   1.1876 0.2254 -0.2142  2.5895  False
       CO       CSO   2.2919    0.0  0.8901  3.6938   True
       CO       CSW    0.203    1.0 -2.0972  2.5033  False
       CO        CV   0.2733    1.0 -0.8491  1.3957  False
       CO       CVO   1.0931 0.1716 -0.1505  2.3367  False
       CO      Corn   0.7553 0.5016 -0.2786  1.7893  False
       CO       MTT   1.0419 0.9582 -1.0155  3.0993  False
       CO     Maize   0.2919    1.0 -1.0689  1.6528  False
       CO   Orchard   0.5061 0.9783  -0.562  1.5741  False
       CO     Other   1.1019 0.9757 -1.1983  3.4022  False
       CO   Pasture   3.7952    0.0  1.7378  5.8526   True
       CO   Sorghum   0.1775    1.0 -1.3483  1.7033  False
       CO   Soybean   1.7535 0.0001  0.5098  2.9971   True
       CO Vegetable   1.6964    0.0  0.6521  2.7407   True
       CO        WO   0.5059 0.9949 -0.7112  1.7231  False
       CO     Wheat   0.6148 0.8706 -0.4482  1.6778  False
       CS       CSO   1.1043 0.2798 -0.2426  2.4512  False
       CS       CSW  -0.9846 0.9915 -3.2517  1.2825  False
       CS        CV  -0.9144 0.1883 -1.9673  0.1385  False
       CS       CVO  -0.0946    1.0 -1.2759  1.0867  False
       CS      Corn  -0.4323 0.9871 -1.3904  0.5257  False
       CS       MTT  -0.1457    1.0  -2.166  1.8746  False
       CS     Maize  -0.8957 0.6215 -2.1998  0.4084  False
       CS   Orchard  -0.6816  0.626 -1.6763  0.3132  False
       CS     Other  -0.0857    1.0 -2.3528  2.1814  False
       CS   Pasture   2.6075 0.0009  0.5872  4.6279   True
       CS   Sorghum  -1.0101 0.6275 -2.4856  0.4653  False
       CS   Soybean   0.5658 0.9758 -0.6155  1.7471  False
       CS Vegetable   0.5088 0.9419 -0.4605   1.478  False
       CS        WO  -0.6817 0.8482 -1.8351  0.4717  False
       CS     Wheat  -0.5728 0.8695 -1.5622  0.4165  False
      CSO       CSW  -2.0889 0.1152  -4.356  0.1782  False
      CSO        CV  -2.0187    0.0 -3.0716 -0.9658   True
      CSO       CVO  -1.1988 0.0421 -2.3801 -0.0176   True
      CSO      Corn  -1.5366    0.0 -2.4947 -0.5786   True
      CSO       MTT    -1.25  0.792 -3.2703  0.7703  False
      CSO     Maize     -2.0    0.0 -3.3041 -0.6959   True
      CSO   Orchard  -1.7859    0.0 -2.7806 -0.7911   True
      CSO     Other    -1.19 0.9419 -3.4571  1.0771  False
      CSO   Pasture   1.5033 0.4649 -0.5171  3.5236  False
      CSO   Sorghum  -2.1144 0.0001 -3.5899  -0.639   True
      CSO   Soybean  -0.5385 0.9856 -1.7198  0.6428  False
      CSO Vegetable  -0.5955 0.8013 -1.5648  0.3737  False
      CSO        WO   -1.786    0.0 -2.9394 -0.6326   True
      CSO     Wheat  -1.6771    0.0 -2.6665 -0.6878   True
      CSW        CV   0.0702    1.0 -2.0356   2.176  False
      CSW       CVO     0.89 0.9957 -1.2828  3.0629  False
      CSW      Corn   0.5523    1.0 -1.5078  2.6123  False
      CSW       MTT   0.8389 0.9999 -1.8828  3.5606  False
      CSW     Maize   0.0889    1.0 -2.1531  2.3309  False
      CSW   Orchard    0.303    1.0 -1.7743  2.3804  False
      CSW     Other   0.8989 0.9999 -2.0107  3.8085  False
      CSW   Pasture   3.5921 0.0006  0.8705  6.3138   True
      CSW   Sorghum  -0.0255    1.0 -2.3713  2.3202  False
      CSW   Soybean   1.5504 0.5482 -0.6224  3.7233  False
      CSW Vegetable   1.4934  0.522 -0.5719  3.5586  False
      CSW        WO   0.3029    1.0 -1.8549  2.4607  False
      CSW     Wheat   0.4118    1.0  -1.663  2.4865  False
       CV       CVO   0.8198 0.0579 -0.0108  1.6505  False
       CV      Corn   0.4821 0.0291  0.0212  0.9429   True
       CV       MTT   0.7687 0.9945 -1.0688  2.6061  False
       CV     Maize   0.0187    1.0 -0.9789  1.0163  False
       CV   Orchard   0.2328  0.991 -0.3001  0.7657  False
       CV     Other   0.8287 0.9974 -1.2771  2.9345  False
       CV   Pasture   3.5219    0.0  1.6845  5.3594   True
       CV   Sorghum  -0.0958    1.0 -1.3088  1.1173  False
       CV   Soybean   1.4802    0.0  0.6496  2.3109   True
       CV Vegetable   1.4232    0.0  0.9395  1.9068   True
       CV        WO   0.2327 0.9999 -0.5578  1.0232  False
       CV     Wheat   0.3416 0.7098 -0.1812  0.8643  False
      CVO      Corn  -0.3378 0.9763 -1.0443  0.3688  False
      CVO       MTT  -0.0512    1.0 -1.9651  1.8628  False
      CVO     Maize  -0.8012 0.5647 -1.9334  0.3311  False
      CVO   Orchard   -0.587 0.3794 -1.3426  0.1685  False
      CVO     Other   0.0088    1.0  -2.164  2.1817  False
      CVO   Pasture   2.7021 0.0001  0.7882   4.616   True
      CVO   Sorghum  -0.9156 0.6116 -2.2416  0.4104  False
      CVO   Soybean   0.6604 0.6715  -0.328  1.6487  False
      CVO Vegetable   0.6033 0.2467 -0.1183   1.325  False
      CVO        WO  -0.5872 0.8002  -1.542  0.3677  False
      CVO     Wheat  -0.4783 0.7451 -1.2267  0.2702  False
     Corn       MTT   0.2866    1.0 -1.4982  2.0714  False
     Corn     Maize  -0.4634 0.9497 -1.3603  0.4336  False
     Corn   Orchard  -0.2492 0.2879 -0.5547  0.0562  False
     Corn     Other   0.3466    1.0 -1.7134  2.4066  False
     Corn   Pasture   3.0399    0.0  1.2551  4.8247   True
     Corn   Sorghum  -0.5778 0.9549 -1.7095  0.5539  False
     Corn   Soybean   0.9982 0.0001  0.2916  1.7047   True
     Corn Vegetable   0.9411    0.0  0.7332   1.149   True
     Corn        WO  -0.2494 0.9984 -0.9083  0.4095  False
     Corn     Wheat  -0.1405 0.9702 -0.4279  0.1468  False
      MTT     Maize    -0.75 0.9985 -2.7421  1.2421  False
      MTT   Orchard  -0.5359 0.9999 -2.3406  1.2689  False
      MTT     Other     0.06    1.0 -2.6617  2.7817  False
      MTT   Pasture   2.7533 0.0161  0.2335   5.273   True
      MTT   Sorghum  -0.8644 0.9957 -2.9726  1.2438  False
      MTT   Soybean   0.7115 0.9987 -1.2024  2.6254  False
      MTT Vegetable   0.6545  0.999 -1.1363  2.4453  False
      MTT        WO   -0.536    1.0 -2.4328  1.3608  False
      MTT     Wheat  -0.4271    1.0 -2.2289  1.3747  False
    Maize   Orchard   0.2141    1.0 -0.7219  1.1501  False
    Maize     Other     0.81 0.9991  -1.432   3.052  False
    Maize   Pasture   3.5033    0.0  1.5112  5.4953   True
    Maize   Sorghum  -0.1144    1.0 -1.5509  1.3221  False
    Maize   Soybean   1.4615 0.0009  0.3293  2.5938   True
    Maize Vegetable   1.4045    0.0  0.4956  2.3133   True
    Maize        WO    0.214    1.0 -0.8892  1.3172  False
    Maize     Wheat   0.3229 0.9995 -0.6074  1.2531  False
  Orchard     Other   0.5959    1.0 -1.4815  2.6732  False
  Orchard   Pasture   3.2891    0.0  1.4844  5.0939   True
  Orchard   Sorghum  -0.3286    1.0 -1.4915  0.8343  False
  Orchard   Soybean   1.2474    0.0  0.4918   2.003   True
  Orchard Vegetable   1.1903    0.0  0.8514  1.5292   True
  Orchard        WO  -0.0001    1.0 -0.7113   0.711  False
  Orchard     Wheat   0.1087    1.0 -0.2839  0.5014  False
    Other   Pasture   2.6933 0.0563 -0.0284  5.4149  False
    Other   Sorghum  -0.9244 0.9973 -3.2702  1.4214  False
    Other   Soybean   0.6515 0.9999 -1.5213  2.8244  False
    Other Vegetable   0.5945    1.0 -1.4708  2.6597  False
    Other        WO   -0.596    1.0 -2.7538  1.5618  False
    Other     Wheat  -0.4871    1.0 -2.5619  1.5876  False
  Pasture   Sorghum  -3.6177    0.0 -5.7259 -1.5095   True
  Pasture   Soybean  -2.0417 0.0225 -3.9556 -0.1278   True
  Pasture Vegetable  -2.0988 0.0055 -3.8896  -0.308   True
  Pasture        WO  -3.2893    0.0 -5.1861 -1.3924   True
  Pasture     Wheat  -3.1804    0.0 -4.9822 -1.3786   True
  Sorghum   Soybean    1.576 0.0043    0.25   2.902   True
  Sorghum Vegetable   1.5189 0.0005  0.3777  2.6601   True
  Sorghum        WO   0.3284    1.0 -0.9728  1.6296  False
  Sorghum     Wheat   0.4373 0.9984  -0.721  1.5956  False
  Soybean Vegetable  -0.0571    1.0 -0.7787  0.6646  False
  Soybean        WO  -1.2475 0.0007 -2.2024 -0.2927   True
  Soybean     Wheat  -1.1387    0.0 -1.8871 -0.3902   True
Vegetable        WO  -1.1905    0.0 -1.8655 -0.5154   True
Vegetable     Wheat  -1.0816    0.0 -1.4043 -0.7589   True
       WO     Wheat   0.1089    1.0 -0.5947  0.8125  False
----------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-13-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="d8e1fe14-abd9-4536-9195-e4971665d6b3" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> [<span class="st">'SoilBD'</span>, <span class="st">'SoilpH'</span>, <span class="st">'CEC'</span>, <span class="st">'MBN_T'</span>]:</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">'Country'</span>, y<span class="op">=</span>var)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f'</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss"> by Country'</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-14-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-14-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-14-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="58348fe4-4218-4a49-b611-4398636133a7" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import seaborn as sns</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Set seaborn style</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.set(style="whitegrid")</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create boxplots for key indicators by CoverCropGroup</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, axes = plt.subplots(3, 1, figsize=(12, 18))</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Boxplot: Soil Bulk Density</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.boxplot(data=subset_df, x='CoverCropGroup', y='SoilBD', ax=axes[0])</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].set_title('Soil Bulk Density by Cover Crop Group')</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].tick_params(axis='x', rotation=45)</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # Boxplot: Soil pH</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.boxplot(data=subset_df, x='CoverCropGroup', y='SoilpH', ax=axes[1])</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].set_title('Soil pH by Cover Crop Group')</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].tick_params(axis='x', rotation=45)</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # Boxplot: MBN_T</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.boxplot(data=subset_df, x='CoverCropGroup', y='MBN_T', ax=axes[2])</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[2].set_title('MBN_T by Cover Crop Group')</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[2].tick_params(axis='x', rotation=45)</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.tight_layout()</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="886c478c-9ea3-429c-9bb6-9da150eba0bf" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Calculate means and standard deviations</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># grouped_means = subset_df.groupby("CoverCropGroup")[["SoilBD", "SoilpH", "MBN_T"]].mean()</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># grouped_stds = subset_df.groupby("CoverCropGroup")[["SoilBD", "SoilpH", "MBN_T"]].std()</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # Group order for plotting</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># group_order = grouped_means.index.tolist()</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create bar plots</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, axes = plt.subplots(3, 1, figsize=(12, 18))</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # SoilBD</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].bar(group_order, grouped_means["SoilBD"], yerr=grouped_stds["SoilBD"], capsize=5)</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].set_title("Mean Soil Bulk Density by Cover Crop Group")</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].set_ylabel("SoilBD")</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].tick_params(axis='x', rotation=45)</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co"># # SoilpH</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].bar(group_order, grouped_means["SoilpH"], yerr=grouped_stds["SoilpH"], capsize=5)</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].set_title("Mean Soil pH by Cover Crop Group")</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].set_ylabel("SoilpH")</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].tick_params(axis='x', rotation=45)</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co"># # MBN_T</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[2].bar(group_order, grouped_means["MBN_T"], yerr=grouped_stds["MBN_T"], capsize=5)</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[2].set_title("Mean MBN_T by Cover Crop Group")</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[2].set_ylabel("MBN_T")</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[2].tick_params(axis='x', rotation=45)</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.tight_layout()</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="84bd650c-0e39-4c2d-9540-ac7a925413fe" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import matplotlib.pyplot as plt</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # List of indicators</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># geo_indicators = ['SoilpH', 'SoilBD', 'CEC', 'SOC', 'MBN_T']</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Ensure SOC is in subset_df</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># if 'SOC' not in subset_df.columns:</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     subset_df['SOC'] = main_df['BackgroundSOC']</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # Grid layout</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># n = len(geo_indicators)</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># cols = 3</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># rows = (n + cols - 1) // cols  # Ceiling division</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create figure and axes</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, axes = plt.subplots(rows, cols, figsize=(5 * cols, 5 * rows), constrained_layout=True)</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># axes = axes.flatten()</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create scatter plots for each indicator</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># for i, indicator in enumerate(geo_indicators):</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     sc = axes[i].scatter(</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co">#         subset_df['Longitude'],</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co">#         subset_df['Latitude'],</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co">#         c=subset_df[indicator],</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co">#         cmap='viridis',</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co">#         alpha=0.7,</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="co">#         edgecolor='k'</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     axes[i].set_title(f"{indicator}")</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     axes[i].set_xlabel("Longitude")</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     axes[i].set_ylabel("Latitude")</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.colorbar(sc, ax=axes[i], label=indicator)</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># # Hide any unused axes</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co"># for j in range(len(geo_indicators), len(axes)):</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     fig.delaxes(axes[j])</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="co"># # Save the combined figure</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.savefig("combined_geographic_distribution.png", dpi=300)</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.close()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inferential-statistics" class="level2">
<h2 class="anchored" data-anchor-id="inferential-statistics">Inferential statistics</h2>
<div id="0a5bf530-f7b4-49fe-9024-6d0edb2a1961" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the soil indicators to test</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>indicators <span class="op">=</span> [<span class="st">'SoilBD'</span>, <span class="st">'SoilpH'</span>, <span class="st">'CEC'</span>, <span class="st">'SOC'</span>, <span class="st">'MBN_T'</span>]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to perform one-way ANOVA for each indicator</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_anova(df, group_col, indicators):</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> {}</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> indicator <span class="kw">in</span> indicators:</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Drop NaNs for the current indicator</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> df[[group_col, indicator]].dropna()</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Group the data by the group_col</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        groups <span class="op">=</span> [group[indicator].values <span class="cf">for</span> name, group <span class="kw">in</span> data.groupby(group_col)]</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(groups) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>            stat, pval <span class="op">=</span> stats.f_oneway(<span class="op">*</span>groups)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>            results[indicator] <span class="op">=</span> {<span class="st">'F-statistic'</span>: stat, <span class="st">'p-value'</span>: pval}</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>            results[indicator] <span class="op">=</span> {<span class="st">'F-statistic'</span>: <span class="va">None</span>, <span class="st">'p-value'</span>: <span class="va">None</span>}</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Run ANOVA for CoverCropGroup</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>anova_results <span class="op">=</span> run_anova(subset_df, <span class="st">'CoverCropGroup'</span>, indicators)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var, res <span class="kw">in</span> anova_results.items():</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">: F = </span><span class="sc">{</span>res[<span class="st">'F-statistic'</span>]<span class="sc">:.3f}</span><span class="ss">, p = </span><span class="sc">{</span>res[<span class="st">'p-value'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SoilBD: F = 2.922, p = 0.0002
SoilpH: F = 11.338, p = 0.0000
CEC: F = 1.503, p = 0.2282
SOC: F = 43.451, p = 0.0000
MBN_T: F = 4.599, p = 0.0000</code></pre>
</div>
</div>
<section id="tukeys-hsd-test---identify-which-specific-cover-crop-groups-differ-post-hoc-analysis-after-anova." class="level3">
<h3 class="anchored" data-anchor-id="tukeys-hsd-test---identify-which-specific-cover-crop-groups-differ-post-hoc-analysis-after-anova.">Tukey’s HSD test - identify which specific cover crop groups differ (post hoc analysis after ANOVA).</h3>
<div id="9a9e6989-6624-40b0-9b46-1f330d4bcb18" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.multicomp <span class="im">import</span> pairwise_tukeyhsd</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop missing values for SOC and CoverCropGroup</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>tukey_data <span class="op">=</span> subset_df[[<span class="st">'SOC'</span>, <span class="st">'CoverCropGroup'</span>]].dropna()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Run Tukey HSD</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="op">=</span> pairwise_tukeyhsd(endog<span class="op">=</span>tukey_data[<span class="st">'SOC'</span>],</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                                 groups<span class="op">=</span>tukey_data[<span class="st">'CoverCropGroup'</span>],</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                                 alpha<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tukey_result.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Multiple Comparison of Means - Tukey HSD, FWER=0.05             
============================================================================
      group1             group2       meandiff p-adj   lower   upper  reject
----------------------------------------------------------------------------
               AVG           Brassica   0.1037    1.0 -0.6314  0.8388  False
               AVG          Broadleaf    -0.15    1.0 -0.9876  0.6876  False
               AVG Broadleaf/Brassica  -1.4196 0.9781 -4.5855  1.7462  False
               AVG              Grass   1.0581    0.0  0.4005  1.7157   True
               AVG                 LB   1.3194 0.3301 -0.3558  2.9946  False
               AVG                 LG  -0.0792    1.0  -0.799  0.6407  False
               AVG                 LL  -0.6939 0.0742 -1.4148   0.027  False
               AVG             Legume  -0.2599 0.9914 -0.8982  0.3784  False
               AVG        Legume_Tree   0.1418    1.0 -0.5411  0.8247  False
               AVG                MMT  -0.4206 0.9954 -1.5173  0.6761  False
               AVG                MOT   0.3669 0.9944 -0.5722   1.306  False
               AVG              Mixed  -0.6103 0.7712 -1.6114  0.3908  False
               AVG                 No   1.3386 0.0012  0.2954  2.3817   True
               AVG      Not_available   0.5094    1.0 -1.7735  2.7923  False
               AVG                Rye  -0.2669 0.9955  -0.964  0.4303  False
          Brassica          Broadleaf  -0.2537 0.9955 -0.9171  0.4097  False
          Brassica Broadleaf/Brassica  -1.5233 0.9539 -4.6476  1.6009  False
          Brassica              Grass   0.9543    0.0  0.5408  1.3678   True
          Brassica                 LB   1.2157 0.3893 -0.3796  2.8109  False
          Brassica                 LG  -0.1829 0.9976 -0.6896  0.3239  False
          Brassica                 LL  -0.7977    0.0 -1.3058 -0.2895   True
          Brassica             Legume  -0.3636 0.0828 -0.7456  0.0184  False
          Brassica        Legume_Tree   0.0381    1.0 -0.4145  0.4908  False
          Brassica                MMT  -0.5243 0.8962 -1.4945  0.4458  False
          Brassica                MOT   0.2632  0.999 -0.5246  1.0509  False
          Brassica              Mixed   -0.714 0.2441 -1.5747  0.1467  False
          Brassica                 No   1.2349 0.0004  0.3256  2.1441   True
          Brassica      Not_available   0.4057    1.0 -1.8193  2.6306  False
          Brassica                Rye  -0.3706 0.3427 -0.8445  0.1033  False
         Broadleaf Broadleaf/Brassica  -1.2696 0.9923 -4.4196  1.8803  False
         Broadleaf              Grass   1.2081    0.0  0.6317  1.7844   True
         Broadleaf                 LB   1.4694 0.1442 -0.1756  3.1144  False
         Broadleaf                 LG   0.0708    1.0 -0.5757  0.7174  False
         Broadleaf                 LL  -0.5439 0.2255 -1.1916  0.1037  False
         Broadleaf             Legume  -0.1099    1.0 -0.6641  0.4444  False
         Broadleaf        Legume_Tree   0.2918  0.958 -0.3133  0.8969  False
         Broadleaf                MMT  -0.2706    1.0 -1.3206  0.7794  False
         Broadleaf                MOT   0.5169 0.8227 -0.3673  1.4011  False
         Broadleaf              Mixed  -0.4603 0.9562 -1.4101  0.4894  False
         Broadleaf                 No   1.4886    0.0  0.4946  2.4825   True
         Broadleaf      Not_available   0.6594 0.9998 -1.6015  2.9202  False
         Broadleaf                Rye  -0.1169    1.0  -0.738  0.5043  False
Broadleaf/Brassica              Grass   2.4777 0.3085 -0.6293  5.5846  False
Broadleaf/Brassica                 LB    2.739 0.3252  -0.729   6.207  False
Broadleaf/Brassica                 LG   1.3405 0.9854 -1.7803  4.4612  False
Broadleaf/Brassica                 LL   0.7257    1.0 -2.3953  3.8466  False
Broadleaf/Brassica             Legume   1.1597 0.9965 -1.9432  4.2627  False
Broadleaf/Brassica        Legume_Tree   1.5614 0.9416  -1.551  4.6739  False
Broadleaf/Brassica                MMT    0.999 0.9996 -2.2295  4.2275  False
Broadleaf/Brassica                MOT   1.7865 0.8631  -1.392   4.965  False
Broadleaf/Brassica              Mixed   0.8093    1.0  -2.388  4.0066  False
Broadleaf/Brassica                 No   2.7582 0.1933 -0.4525  5.9689  False
Broadleaf/Brassica      Not_available    1.929 0.9356   -1.87   5.728  False
Broadleaf/Brassica                Rye   1.1527 0.9969 -1.9628  4.2683  False
             Grass                 LB   0.2613    1.0 -1.2998  1.8224  False
             Grass                 LG  -1.1372    0.0 -1.5231 -0.7514   True
             Grass                 LL   -1.752    0.0 -2.1397 -1.3643   True
             Grass             Legume  -1.3179    0.0  -1.513 -1.1229   True
             Grass        Legume_Tree  -0.9162    0.0 -1.2277 -0.6048   True
             Grass                MMT  -1.4787    0.0 -2.3916 -0.5658   True
             Grass                MOT  -0.6912 0.0721 -1.4071  0.0248  False
             Grass              Mixed  -1.6684    0.0 -2.4639 -0.8728   True
             Grass                 No   0.2805 0.9991 -0.5673  1.1283  False
             Grass      Not_available  -0.5487    1.0 -2.7492  1.6519  False
             Grass                Rye  -1.3249    0.0 -1.6665 -0.9833   True
                LB                 LG  -1.3985 0.1612 -2.9869  0.1898  False
                LB                 LL  -2.0133 0.0016 -3.6021 -0.4246   True
                LB             Legume  -1.5793 0.0415 -3.1323 -0.0262   True
                LB        Legume_Tree  -1.1776 0.4208 -2.7494  0.3943  False
                LB                MMT    -1.74 0.0676 -3.5309  0.0509  False
                LB                MOT  -0.9525 0.8655 -2.6515  0.7465  False
                LB              Mixed  -1.9297 0.0132 -3.6637 -0.1957   True
                LB                 No   0.0192    1.0 -1.7394  1.7778  False
                LB      Not_available    -0.81 0.9997 -3.4963  1.8763  False
                LB                Rye  -1.5863 0.0473 -3.1644 -0.0081   True
                LG                 LL  -0.6148 0.0016 -1.1007 -0.1289   True
                LG             Legume  -0.1807 0.9296 -0.5326  0.1712  False
                LG        Legume_Tree    0.221 0.9259 -0.2066  0.6485  False
                LG                MMT  -0.3415 0.9979 -1.3002  0.6173  False
                LG                MOT    0.446 0.8377 -0.3275  1.2196  False
                LG              Mixed  -0.5312 0.7329 -1.3789  0.3166  False
                LG                 No   1.4177    0.0  0.5207  2.3147   True
                LG      Not_available   0.5885 0.9999 -1.6314  2.8085  False
                LG                Rye  -0.1877  0.989 -0.6377  0.2623  False
                LL             Legume   0.4341 0.0028  0.0801   0.788   True
                LL        Legume_Tree   0.8358    0.0  0.4065   1.265   True
                LL                MMT   0.2733 0.9999 -0.6862  1.2328  False
                LL                MOT   1.0608 0.0003  0.2863  1.8353   True
                LL              Mixed   0.0836    1.0  -0.765  0.9322  False
                LL                 No   2.0325    0.0  1.1347  2.9303   True
                LL      Not_available   1.2033 0.8941 -1.0169  3.4236  False
                LL                Rye   0.4271 0.0879 -0.0245  0.8787  False
            Legume        Legume_Tree   0.4017    0.0  0.1335    0.67   True
            Legume                MMT  -0.1607    1.0 -1.0598  0.7383  False
            Legume                MOT   0.6268 0.1386 -0.0715  1.3251  False
            Legume              Mixed  -0.3504 0.9776 -1.1301  0.4292  False
            Legume                 No   1.5985    0.0  0.7655  2.4314   True
            Legume      Not_available   0.7693 0.9983 -1.4256  2.9641  False
            Legume                Rye   -0.007    1.0 -0.3097  0.2958  False
       Legume_Tree                MMT  -0.5624 0.7834 -1.4937  0.3688  False
       Legume_Tree                MOT   0.2251 0.9997 -0.5142  0.9643  False
       Legume_Tree              Mixed  -0.7521 0.1116 -1.5687  0.0644  False
       Legume_Tree                 No   1.1967 0.0003  0.3292  2.0643   True
       Legume_Tree      Not_available   0.3676    1.0 -1.8407  2.5758  False
       Legume_Tree                Rye  -0.4087 0.0274 -0.7968 -0.0206   True
               MMT                MOT   0.7875 0.5595 -0.3451  1.9202  False
               MMT              Mixed  -0.1897    1.0 -1.3742  0.9949  False
               MMT                 No   1.7592 0.0001  0.5389  2.9795   True
               MMT      Not_available     0.93 0.9941 -1.4391  3.2991  False
               MMT                Rye   0.1537    1.0  -0.788  1.0955  False
               MOT              Mixed  -0.9772 0.0937 -2.0176  0.0632  False
               MOT                 No   0.9717 0.1369 -0.1092  2.0526  False
               MOT      Not_available   0.1425    1.0 -2.1579  2.4429  False
               MOT                Rye  -0.6338 0.2213 -1.3863  0.1187  False
             Mixed                 No   1.9489    0.0  0.8137  3.0841   True
             Mixed      Not_available   1.1197 0.9587 -1.2067  3.4461  False
             Mixed                Rye   0.3434 0.9897 -0.4851   1.172  False
                No      Not_available  -0.8292 0.9981  -3.174  1.5156  False
                No                Rye  -1.6055    0.0 -2.4843 -0.7266   True
     Not_available                Rye  -0.7763 0.9983 -2.9889  1.4364  False
----------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="regression-analysis---models-soil-indicators-like-soc-while-controlling-for-geography-e.g.-latitude-climate-etc.." class="level3">
<h3 class="anchored" data-anchor-id="regression-analysis---models-soil-indicators-like-soc-while-controlling-for-geography-e.g.-latitude-climate-etc..">Regression Analysis - models soil indicators (like SOC) while controlling for geography (e.g., latitude, climate, etc.).</h3>
<p><span class="math display">\[
SOC = \beta_0 + \beta_1 \cdot \text{CoverCropGroup} + \beta_2 \cdot \text{Latitude} + \beta_3 \cdot \text{Elevation} + \epsilon
\]</span></p>
<div id="4eaab607-ac5e-40a9-8b5d-aa74b9c9f133" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>reg_df <span class="op">=</span> subset_df[[<span class="st">'SOC'</span>, <span class="st">'CoverCropGroup'</span>, <span class="st">'Latitude'</span>, <span class="st">'Elevation'</span>]].dropna()</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Run linear regression</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(<span class="st">'SOC ~ C(CoverCropGroup) + Latitude + Elevation'</span>, data<span class="op">=</span>reg_df).fit()</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    SOC   R-squared:                       0.246
Model:                            OLS   Adj. R-squared:                  0.240
Method:                 Least Squares   F-statistic:                     45.66
Date:                Fri, 11 Jul 2025   Prob (F-statistic):          2.95e-132
Time:                        20:55:47   Log-Likelihood:                -3107.8
No. Observations:                2400   AIC:                             6252.
Df Residuals:                    2382   BIC:                             6356.
Df Model:                          17                                         
Covariance Type:            nonrobust                                         
===========================================================================================================
                                              coef    std err          t      P&gt;|t|      [0.025      0.975]
-----------------------------------------------------------------------------------------------------------
Intercept                                   1.4288      0.188      7.600      0.000       1.060       1.797
C(CoverCropGroup)[T.Brassica]               0.2776      0.211      1.314      0.189      -0.137       0.692
C(CoverCropGroup)[T.Broadleaf]              0.1967      0.242      0.812      0.417      -0.278       0.672
C(CoverCropGroup)[T.Broadleaf/Brassica]    -0.8828      0.907     -0.974      0.330      -2.661       0.895
C(CoverCropGroup)[T.Grass]                  1.1028      0.189      5.844      0.000       0.733       1.473
C(CoverCropGroup)[T.LB]                     1.3971      0.479      2.917      0.004       0.458       2.336
C(CoverCropGroup)[T.LG]                    -0.0663      0.206     -0.322      0.748      -0.470       0.338
C(CoverCropGroup)[T.LL]                    -0.3076      0.212     -1.453      0.146      -0.723       0.107
C(CoverCropGroup)[T.Legume]                 0.0661      0.186      0.356      0.722      -0.298       0.430
C(CoverCropGroup)[T.Legume_Tree]            0.4306      0.200      2.155      0.031       0.039       0.822
C(CoverCropGroup)[T.MMT]                   -0.4994      0.314     -1.593      0.111      -1.114       0.116
C(CoverCropGroup)[T.MOT]                    0.3804      0.268      1.417      0.157      -0.146       0.907
C(CoverCropGroup)[T.Mixed]                 -0.5867      0.287     -2.048      0.041      -1.149      -0.025
C(CoverCropGroup)[T.No]                     1.5098      0.299      5.052      0.000       0.924       2.096
C(CoverCropGroup)[T.Not_available]          0.7292      0.653      1.117      0.264      -0.551       2.010
C(CoverCropGroup)[T.Rye]                   -0.2206      0.200     -1.106      0.269      -0.612       0.171
Latitude                                    0.0048      0.001      4.685      0.000       0.003       0.007
Elevation                                  -0.0003   4.52e-05     -6.003      0.000      -0.000      -0.000
==============================================================================
Omnibus:                      684.451   Durbin-Watson:                   0.302
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             1962.291
Skew:                           1.477   Prob(JB):                         0.00
Kurtosis:                       6.302   Cond. No.                     4.20e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 4.2e+04. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
</section>
<section id="boxplots-with-significance-markers---visuals-showing-group-means-and-marking-pairs-with-significant-differences." class="level3">
<h3 class="anchored" data-anchor-id="boxplots-with-significance-markers---visuals-showing-group-means-and-marking-pairs-with-significant-differences.">Boxplots with Significance Markers - visuals showing group means and marking pairs with significant differences.</h3>
<div id="0ab828c7-88f0-49fe-97bb-d8a0ac1edd7f" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scikit_posthocs <span class="im">as</span> sp</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey HSD using scikit-posthocs</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>soc_data <span class="op">=</span> subset_df[[<span class="st">'CoverCropGroup'</span>, <span class="st">'SOC'</span>]].dropna()</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>tukey_letters <span class="op">=</span> sp.posthoc_tukey(soc_data, val_col<span class="op">=</span><span class="st">'SOC'</span>, group_col<span class="op">=</span><span class="st">'CoverCropGroup'</span>, sort<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplot</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.boxplot(data<span class="op">=</span>soc_data, x<span class="op">=</span><span class="st">'CoverCropGroup'</span>, y<span class="op">=</span><span class="st">'SOC'</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'SOC by Cover Crop Group with Tukey HSD Groupings'</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display grouping letters</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Tukey HSD Groupings:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tukey_letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Tukey HSD Groupings:

                         AVG      Brassica     Broadleaf  Broadleaf/Brassica  \
AVG                 1.000000  1.000000e+00  9.999997e-01            0.978061   
Brassica            1.000000  1.000000e+00  9.955310e-01            0.953886   
Broadleaf           1.000000  9.955310e-01  1.000000e+00            0.992263   
Broadleaf/Brassica  0.978061  9.538857e-01  9.922631e-01            1.000000   
Grass               0.000004  3.390621e-13  1.046002e-10            0.308548   
LB                  0.330089  3.892789e-01  1.441518e-01            0.325228   
LG                  1.000000  9.976211e-01  1.000000e+00            0.985414   
LL                  0.074183  9.430263e-06  2.254724e-01            0.999989   
Legume              0.991425  8.280944e-02  9.999988e-01            0.996508   
Legume_Tree         0.999998  1.000000e+00  9.579748e-01            0.941589   
MMT                 0.995393  8.962296e-01  9.999592e-01            0.999600   
MOT                 0.994401  9.990087e-01  8.226694e-01            0.863131   
Mixed               0.771158  2.441072e-01  9.561657e-01            0.999968   
No                  0.001221  3.778758e-04  3.522957e-05            0.193250   
Not_available       0.999994  9.999996e-01  9.998055e-01            0.935627   
Rye                 0.995487  3.426549e-01  9.999994e-01            0.996872   

                           Grass        LB        LG            LL  \
AVG                 4.482814e-06  0.330089  1.000000  7.418287e-02   
Brassica            3.390621e-13  0.389279  0.997621  9.430263e-06   
Broadleaf           1.046002e-10  0.144152  1.000000  2.254724e-01   
Broadleaf/Brassica  3.085484e-01  0.325228  0.985414  9.999894e-01   
Grass               1.000000e+00  1.000000  0.000000  0.000000e+00   
LB                  9.999999e-01  1.000000  0.161193  1.552732e-03   
LG                  0.000000e+00  0.161193  1.000000  1.600530e-03   
LL                  0.000000e+00  0.001553  0.001601  1.000000e+00   
Legume              0.000000e+00  0.041507  0.929578  2.830544e-03   
Legume_Tree         0.000000e+00  0.420827  0.925908  3.594671e-09   
MMT                 3.639509e-06  0.067625  0.997946  9.998547e-01   
MOT                 7.213385e-02  0.865511  0.837698  3.133404e-04   
Mixed               1.014878e-10  0.013177  0.732883  1.000000e+00   
No                  9.991143e-01  1.000000  0.000008  1.338263e-12   
Not_available       9.999734e-01  0.999707  0.999941  8.940954e-01   
Rye                 0.000000e+00  0.047272  0.989050  8.794790e-02   

                          Legume   Legume_Tree       MMT       MOT  \
AVG                 9.914251e-01  9.999977e-01  0.995393  0.994401   
Brassica            8.280944e-02  1.000000e+00  0.896230  0.999009   
Broadleaf           9.999988e-01  9.579748e-01  0.999959  0.822669   
Broadleaf/Brassica  9.965080e-01  9.415894e-01  0.999600  0.863131   
Grass               0.000000e+00  0.000000e+00  0.000004  0.072134   
LB                  4.150723e-02  4.208271e-01  0.067625  0.865511   
LG                  9.295775e-01  9.259076e-01  0.997946  0.837698   
LL                  2.830544e-03  3.594671e-09  0.999855  0.000313   
Legume              1.000000e+00  3.533503e-05  1.000000  0.138615   
Legume_Tree         3.533503e-05  1.000000e+00  0.783375  0.999671   
MMT                 9.999997e-01  7.833750e-01  1.000000  0.559461   
MOT                 1.386146e-01  9.996710e-01  0.559461  1.000000   
Mixed               9.775771e-01  1.116075e-01  1.000000  0.093704   
No                  6.815660e-09  2.673565e-04  0.000094  0.136925   
Not_available       9.982850e-01  9.999999e-01  0.994113  1.000000   
Rye                 1.000000e+00  2.737549e-02  1.000000  0.221306   

                           Mixed            No  Not_available           Rye  
AVG                 7.711579e-01  1.220596e-03       0.999994  9.954867e-01  
Brassica            2.441072e-01  3.778758e-04       1.000000  3.426549e-01  
Broadleaf           9.561657e-01  3.522957e-05       0.999805  9.999994e-01  
Broadleaf/Brassica  9.999677e-01  1.932501e-01       0.935627  9.968716e-01  
Grass               1.014878e-10  9.991143e-01       0.999973  0.000000e+00  
LB                  1.317682e-02  1.000000e+00       0.999707  4.727169e-02  
LG                  7.328834e-01  7.693323e-06       0.999941  9.890498e-01  
LL                  1.000000e+00  1.338263e-12       0.894095  8.794790e-02  
Legume              9.775771e-01  6.815660e-09       0.998285  1.000000e+00  
Legume_Tree         1.116075e-01  2.673565e-04       1.000000  2.737549e-02  
MMT                 9.999999e-01  9.397006e-05       0.994113  9.999999e-01  
MOT                 9.370393e-02  1.369253e-01       1.000000  2.213062e-01  
Mixed               1.000000e+00  5.304018e-07       0.958706  9.897287e-01  
No                  5.304018e-07  1.000000e+00       0.998104  5.266005e-08  
Not_available       9.587062e-01  9.981035e-01       1.000000  9.982664e-01  
Rye                 9.897287e-01  5.266005e-08       0.998266  1.000000e+00  </code></pre>
</div>
</div>
<div id="bde97ed7-d10d-4b3d-9be8-38cba4280f1a" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load your Excel file</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">"SoilHealthDB_V2.xlsx"</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>excel_file <span class="op">=</span> pd.ExcelFile(file_path)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>main_df <span class="op">=</span> excel_file.parse(<span class="st">"Sheet1"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the subset DataFrame with required columns</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>columns_of_interest <span class="op">=</span> [</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CoverCropGroup'</span>, <span class="st">'SoilBD'</span>, <span class="st">'SoilpH'</span>, <span class="st">'CEC'</span>, <span class="st">'BackgroundSOC'</span>, <span class="st">'MBN_T'</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>subset_df <span class="op">=</span> main_df[columns_of_interest].copy()</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>subset_df.rename(columns<span class="op">=</span>{<span class="st">'BackgroundSOC'</span>: <span class="st">'SOC'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Define soil indicators to plot</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>indicators <span class="op">=</span> [<span class="st">'SoilBD'</span>, <span class="st">'SoilpH'</span>, <span class="st">'CEC'</span>, <span class="st">'SOC'</span>, <span class="st">'MBN_T'</span>]</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the subplot grid</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each indicator and create a boxplot</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, indicator <span class="kw">in</span> <span class="bu">enumerate</span>(indicators):</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop missing values for this indicator</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> subset_df[[<span class="st">'CoverCropGroup'</span>, indicator]].dropna()</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if there's enough data to plot</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data[<span class="st">'CoverCropGroup'</span>].nunique() <span class="op">&gt;</span> <span class="dv">1</span> <span class="kw">and</span> <span class="bu">len</span>(data) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        sns.boxplot(data<span class="op">=</span>data, x<span class="op">=</span><span class="st">'CoverCropGroup'</span>, y<span class="op">=</span>indicator, ax<span class="op">=</span>axes[i])</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>        axes[i].set_title(<span class="ss">f'</span><span class="sc">{</span>indicator<span class="sc">}</span><span class="ss"> by Cover Crop Group'</span>)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        axes[i].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>        axes[i].set_visible(<span class="va">False</span>)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide any remaining unused subplots</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(indicators) <span class="op">&lt;</span> <span class="bu">len</span>(axes):</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(indicators), <span class="bu">len</span>(axes)):</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>        fig.delaxes(axes[j])</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplots-by-country" class="level3">
<h3 class="anchored" data-anchor-id="boxplots-by-country">Boxplots by Country</h3>
<div id="00b4a2b9-f15b-46b9-af29-2536e9fddae6" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Excel file</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">"SoilHealthDB_V2.xlsx"</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>excel_file <span class="op">=</span> pd.ExcelFile(file_path)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>main_df <span class="op">=</span> excel_file.parse(<span class="st">"Sheet1"</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename BackgroundSOC to SOC for clarity</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>main_df <span class="op">=</span> main_df.copy()</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>main_df.rename(columns<span class="op">=</span>{<span class="st">'BackgroundSOC'</span>: <span class="st">'SOC'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define indicators to plot</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>indicators <span class="op">=</span> [<span class="st">'SoilBD'</span>, <span class="st">'SoilpH'</span>, <span class="st">'CEC'</span>, <span class="st">'SOC'</span>, <span class="st">'MBN_T'</span>]</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the subplot grid (2 rows, 3 columns)</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate boxplots for each soil indicator grouped by Country</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, indicator <span class="kw">in</span> <span class="bu">enumerate</span>(indicators):</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> main_df[[<span class="st">'Country'</span>, indicator]].dropna()</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data[<span class="st">'Country'</span>].nunique() <span class="op">&gt;</span> <span class="dv">1</span> <span class="kw">and</span> <span class="bu">len</span>(data) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>        sns.boxplot(data<span class="op">=</span>data, x<span class="op">=</span><span class="st">'Country'</span>, y<span class="op">=</span>indicator, ax<span class="op">=</span>axes[i])</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>        axes[i].set_title(<span class="ss">f'</span><span class="sc">{</span>indicator<span class="sc">}</span><span class="ss"> by Country'</span>)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>        axes[i].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>        axes[i].set_visible(<span class="va">False</span>)</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove unused subplots if necessary</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(indicators) <span class="op">&lt;</span> <span class="bu">len</span>(axes):</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(indicators), <span class="bu">len</span>(axes)):</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>        fig.delaxes(axes[j])</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="question_1_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/eleshuk\.github\.io\/avcad_2025\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>